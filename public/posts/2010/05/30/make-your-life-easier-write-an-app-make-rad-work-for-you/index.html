<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="https://tenbulls.co.uk/favicon.ico" />
<meta property="og:url" content="https://tenbulls.co.uk/posts/2010/05/30/make-your-life-easier-write-an-app-make-rad-work-for-you/">
  <meta property="og:site_name" content="tenbulls blog">
  <meta property="og:title" content="Develop query tool to return multi-query results">
  <meta property="og:description" content="Quite often I come across scenarios where you know what you need to do, you know how to do them, but know the way to do it will be very repetitive in SSMS. In these instances the best way to overcome them is to create a few queries and join them up into a little applet.
One such example I had recently was that we wanted a way to very quickly check several servers for privileged database and server role membership.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2010-05-30T16:41:00+01:00">
    <meta property="article:modified_time" content="2010-05-30T16:41:00+01:00">

<title>tenbulls blog | Develop query tool to return multi-query results</title>

      <link rel="stylesheet" href="/css/main.min.e527a301080eb1b5d1bbc5aa41af83b36de499b1bcf899fc56d075ab38c5027c.css" integrity="sha256-5SejAQgOsbXRu8WqQa&#43;Ds23kmbG8&#43;Jn8VtB1qzjFAnw=" crossorigin="anonymous">
        <link rel="stylesheet" href="/css/palette/default.min.98db41a18eb278705557b678b4ad23b154f0f60e0dc69d3672f24207a951505b.css" integrity="sha256-mNtBoY6yeHBVV7Z4tK0jsVTw9g4Nxp02cvJCB6lRUFs=" crossorigin="anonymous">

      <script src="/js/main.86bb3d8e6f46df0fc97c2731e6b99175a13b87a4086acf578ff9b6992fcf32c1.js" integrity="sha256-hrs9jm9G3w/JfCcx5rmRdaE7h6QIas9Xj/m2mS/PMsE=" crossorigin="anonymous"></script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>

<body
    class="dark"
>
  
  <main>
    
  <div class="container pt-5">
    <div class="row mt-5 pt-5">
      
  <nav aria-label="breadcrumb" class="small navbar navbar-expand-lg">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleMenu" aria-controls="collapsibleMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse mt-3 mt-md-0" id="collapsibleMenu">
      <ol class="breadcrumb fw-bold">
    <li class="breadcrumb-item my-1 my-md-0 ms-3 ms-md-0">
      <a href="/about"
        
      >about</a>
      
    </li>
    <li class="breadcrumb-item my-1 my-md-0 ms-3 ms-md-0">
      <a href="/"
        
      >home</a>
      
    </li>
    <li class="breadcrumb-item my-1 my-md-0 ms-3 ms-md-0">
      <a href="https://www.meetup.com/hybrid-virtual-group/"
        
          target="_blank" rel="noopener noreferrer"
        
      >meetup</a>
      
    </li>
    <li class="breadcrumb-item my-1 my-md-0 ms-3 ms-md-0">
      <a href="/posts"
        class="text-decoration-underline link-offset-3"
        
      >posts</a>
      
    </li>
      </ol>
    </div>
  </nav>

    </div>
    <div class="post">
      <header class="mb-4">
        <h1 class="text-uppercase">Develop query tool to return multi-query results</h1>
        
        
        <div aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item small">
              
              <time datetime="2010-05-30T16:41:00&#43;01:00">May 30, 2010</time>
            </li>
            
            
            <li class="breadcrumb-item small">
              2 minutes
            </li>
          </ol>
        </div>
      </header>
      
      <article>
        <p>Quite often I come across scenarios where you know what you need to do, you know how to do them, but know the way to do it will be very repetitive in SSMS. In these instances the best way to overcome them is to create a few queries and join them up into a little applet.</p>
<p>One such example I had recently was that we wanted a way to very quickly check several servers for privileged database and server role membership.</p>
<p>So in simple terms I needed to see every login that was a member of any of the server roles and in addition I needed to see any database user that was a member of database owners database role or the owner of the database directly.</p>
<p><img src="/images/2010/applet1.jpg" alt="Query results object"></p>
<p>This is actually something that you would have thought should be pretty easy to do in SSMS, but this is not really the case. The GUI requires that each principal is looked at one at a time in turn viewing the membership of each, and it is quite labourious and infuriating when there are many to look at.</p>
<p>The solution is relatively simple to code in T-SQL using the Dynamic Management Objects but running this script against more than a couple of servers in an adhoc fashion really could be simplified. In my particular situation I was asked to task a junior (non SQL operational) DBA with compiling this information and therefore the obvious solution to was to make this as easy as possible for them. It took me around 15 minutes or less to write a front end GUI which allows the user to enter the server name in a text box and both queries are ran against the server in question and the results are presented in a MDI child split pane window.</p>
<p><img src="/images/2010/applet2.jpg" alt="MDI"></p>
<p>Maybe one day SSMS will provide more extensible functionality, but for now small applets in certain situations work well for me.</p>

      </article>
      

      <div class="row">
    <div class="col-md">
        
        <a href="https://tenbulls.co.uk/posts/2010/05/20/ssms-query-pane-bug-in-windows-7-its-bugging-me/">
            <span>previous: </span>
            <span>SSMS query pane bug in Windows 7</span>
        </a>
        
    </div>
    <div class="col-md text-md-end">
        
        <a href="https://tenbulls.co.uk/posts/2010/07/08/how-to-set-and-manage-your-sql-server-default-paths/">
            <span>next: </span>
            <span>How to set and manage your SQL Server default paths</span>
        </a>
        
    </div>
</div>
      
    </div>
  </div>
  <footer>
    <div class="container mt-4 pb-1">
    <p class="small opacity-75">
        Copyright Â© 2026 Mark Broadbent
        
    </p>
</div>

  </footer>

  </main>

  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
